- name: Update Ubuntu on VMWare Workstation 16
  hosts: vmnet0
  become: true
  gather_facts: true
  tasks:
    - name: Update APT Cache
      ansible.builtin.apt:
        update_cache: true
    - name: Upgrade Packages
      ansible.builtin.apt:
        upgrade: true
        autoremove: true
      notify:
        - Reboot VMs
  handlers:
    - name: Reboot VMs
      ansible.builtin.reboot:
        reboot_timeout: 300
        post_reboot_delay: 30
      when: upgrade_result.changed